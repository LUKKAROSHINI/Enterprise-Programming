package section7.jdbcProgram;
import java.sql.*;
import java.util.*;

public class App {
    public static void main(String[] args) {
        try {
            // Connect to the database
            Connection con = DriverManager.getConnection("jdbc:mysql://localhost", "root", "rosh");
            
            // Create a statement object to execute queries
            Statement s = con.createStatement();

            // Create a Scanner object to take user input
            Scanner ob = new Scanner(System.in);
            
            System.out.println("Enter the ID number:");
            int sid = ob.nextInt();
            
            System.out.println("Enter the name:");
            String sname = ob.next();
            
            System.out.println("Enter the cgpa:");
            float scgpa = ob.nextFloat();
            
            // Construct the insert query
            String query1 = "use section7";
          //  String query2 = "INSERT INTO student (id, name, cgpa) VALUES (" + id + ", '" + name + "',"+cgpa+")";
            String query2 = "insert into student(id,name,cgpa)values(?,?,?)";
           
            PreparedStatement ps;  // declare preparedStatement object
         
            ps = con.prepareStatement(query2);
            
            
          ps.setInt(1,sid);
          ps.setString(2, sname);
          ps.setFloat(3, scgpa);
          s.execute(query1);
          ps.executeUpdate();
         
            // Add queries to batch
            s.addBatch(query1);
             s.addBatch(query2);
            // Execute the batch of queries
            s.executeBatch();
            
            System.out.println("Given task executed successfully");
            
            // Close the Scanner object
            ob.close();
        } catch (Exception e) {
            System.out.println(e);
        }
    }
}
